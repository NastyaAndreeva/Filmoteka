{"mappings":"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","sources":["src/js/library-draw.js","src/templates/list-of-card-library.hbs"],"sourcesContent":["import itemsTemplate from '../templates/list-of-card-library.hbs';\nimport getUsersMovieList from '../js/api/firebase/firebase_read_db';\nimport auth from './api/firebase/auth_firebase';\n\nconst axios = require('axios').default;\nconst API_KEY = '842344de8347536aefc6f17e8e76d4bd';\nconst MOVIE_URL = `https://api.themoviedb.org/3/movie/`;\nconst galleryLibrary = document.querySelector('#library-gallery');\nconst btnSignOut = document.querySelector('#signout-library');\nconst btnWatched = document.querySelector('#btn-watched');  // Select Watched button\nconst btnQueue = document.querySelector('#btn-queue');      // Select Queue button\nconst upBtn = document.querySelector('.go-up');             // button up to top page\nbtnWatched.addEventListener('click', onLibraryBtnClick);    // Set the listener on Watch button\nbtnQueue.addEventListener('click', onLibraryBtnClick);      // Set the listener on Queque button\nupBtn.addEventListener('click', onUpClick);                 // Set the listener on Button Up\nbtnSignOut.addEventListener('click', auth.logOut);\nconst googleUserLibrary = document.querySelector('#googleUserLibrary');\ngoogleUserLibrary.textContent = localStorage.getItem('user-name');\n\nlet pageOfList = 1;             // package number\nlet marker = false;             // a marker of whether the received packet is drawn\nlet typeOfList = 'btn-queue';   // initial value of page type (Queue)\nlet listofMovie;                // global var for scrolling\n\n// -------------------------- drawing initial page\ngetUsersMovieList(typeOfList).then(generateLibraryMarkup); \n\n// -------------------------- handle button click\nasync function onLibraryBtnClick(event) {\n    typeOfList = event.target.id;   // pull target info about type of list\n    readyToNew(typeOfList);         // clear old data\n    await getUsersMovieList(typeOfList, event).then(generateLibraryMarkup); // drawing initial selected page\n};\n\n// -------------------------- preparation before drawing\nfunction readyToNew(typeOfList) {\n    btnChangeColor(typeOfList);         // clear field\n    galleryLibrary.innerHTML = \"\";      // clear content \n    pageOfList = 1;                     // return to the initial value of the packet (=1)\n}\n\n// -------------------------- generate the markup\nasync function generateLibraryMarkup(usersList) {\n    const moviesPerPage = 12;                                                                   // cards per fetch\n    listofMovie = usersList;                                                                    // set global value for scrolling                                                                     // current page for markup\n    let startItemPosition = (pageOfList - 1) * moviesPerPage;                                   // first item in list for murkup\n    let onePageList = usersList.slice(startItemPosition, startItemPosition + moviesPerPage);    // get list of movie's id for current fetch\n    onePageList = await makeArreyOfDataMovies(onePageList);                                     // making array of the movie objects = movies id list \n    galleryLibrary.insertAdjacentHTML('beforeend', itemsTemplate(onePageList));                 // drawinf gallery\n    document.body.style.cursor = 'default';                                                     // \n    marker = true;                                                                              // set markup (ready)\n}\n\n// -------------------------- making movies data object array\nasync function makeArreyOfDataMovies(array) {\n    document.body.style.cursor = 'wait';\n    const arr = await Promise.all(array.map(async (el) => {\n        el = await axios.get(`${MOVIE_URL}${el}`, { params: { api_key: API_KEY, language: 'ru-RU' } }); // fetch data by movie id\n        el = el.data;                                                                                   \n        el.name = el.title.toUpperCase();                                                               // ajust data for the template\n        el.release = el.release_date?.slice(0, 4) || 2022;\n        el.genres = el.genres.map(item => item = item.name);                                            // convert genres data object to genres array\n        return el;\n    }\n    ))\n    return Promise.resolve(arr);\n}\n\n// --------------------------- btn Change Color\nfunction btnChangeColor(ev) {\n    if (ev === 'btn-watched' && !btnWatched.classList.contains('active-btn')) {\n        btnWatched.classList.toggle(\"active-btn\");\n        btnQueue.classList.toggle(\"active-btn\");\n        return\n    }\n\n    if (ev === 'btn-queue' && !btnQueue.classList.contains('active-btn')) {\n        btnQueue.classList.toggle(\"active-btn\");\n        btnWatched.classList.toggle(\"active-btn\");\n        return\n    }\n}\n\n// scroll handle to add an endless gallery\nwindow.addEventListener(\"scroll\", () => {\n    const docRect = document.documentElement.getBoundingClientRect();   // gain access to the screen area\n    if (docRect.bottom < document.documentElement.clientHeight + 150 && marker && (listofMovie.length / 12) >= pageOfList) {   // if the scroll reached 150 from below and the token allows (to avoid duplication of requests), then we process the request\n        marker = false;\n        pageOfList++;                                   // increase the packet number by 1\n        generateLibraryMarkup(listofMovie);\n    }\n\n    if (window.pageYOffset > 70) {                      // on / off button up\n        upBtn.classList.add(\"on-screen\")}\n        else {upBtn.classList.remove(\"on-screen\")}\n});\n\n// handle a click on the button Up\nfunction onUpClick() {\n    document.documentElement.scrollTop = 0;\n}\n\n","{{#each this}}\n  <div class='movie-card'>\n    <img src='https://image.tmdb.org/t/p/w500{{poster_path}}' alt={{name}} />\n    <div class='movie-data'>\n      <h5 class='movie-name'>{{name}}</h5>\n      <p class='movie-info'>{{genres}} | {{release}} <span class='movie-vote'>{{vote_average}}</span></p>\n    </div>\n  </div>\n{{/each}}"],"names":["$bpxeT","parcelRequire","$l5bVx","$3a414a0c09fb77bf$export$2e2bcd8739ae039","$parcel$interopDefault","template","container","depth0","helpers","partials","data","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","name","hash","loc","start","line","column","end","compiler","main","stack1","fn","program","inverse","noop","useData","default","$165c396bfca69de6$var$API_KEY","$165c396bfca69de6$var$MOVIE_URL","$165c396bfca69de6$var$galleryLibrary","document","querySelector","$165c396bfca69de6$var$btnSignOut","$165c396bfca69de6$var$btnWatched","$165c396bfca69de6$var$btnQueue","$165c396bfca69de6$var$upBtn","addEventListener","$165c396bfca69de6$var$onLibraryBtnClick","documentElement","scrollTop","$lFa0r","logOut","textContent","localStorage","getItem","$165c396bfca69de6$var$listofMovie","$165c396bfca69de6$var$pageOfList","$165c396bfca69de6$var$marker","$165c396bfca69de6$var$typeOfList","event","$165c396bfca69de6$var$_onLibraryBtnClick","apply","this","arguments","$2TvXO","mark","_callee","$165c396bfca69de6$var$readyToNew","target","id","$zBkAB","then","$165c396bfca69de6$var$generateLibraryMarkup","typeOfList1","ev","classList","contains","toggle","$165c396bfca69de6$var$btnChangeColor","innerHTML","usersList","$165c396bfca69de6$var$_generateLibraryMarkup","startItemPosition","onePageList","slice","$165c396bfca69de6$var$makeArreyOfDataMovies","_ctx","sent","insertAdjacentHTML","body","style","cursor","array","$165c396bfca69de6$var$_makeArreyOfDataMovies","_callee1","arr","Promise","all","map","el","ref","$165c396bfca69de6$require$axios","get","concat","params","api_key","language","title","toUpperCase","release","release_date","genres","item","_ctx1","resolve","window","getBoundingClientRect","bottom","clientHeight","length","pageYOffset","add","remove"],"version":3,"file":"library.e492669f.js.map"}