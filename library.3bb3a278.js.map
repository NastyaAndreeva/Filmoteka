{"mappings":"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","sources":["src/js/library-draw.js","src/templates/list-of-card-library.hbs"],"sourcesContent":["import constants from '../constants/constants';\nimport itemsTemplate from '../templates/list-of-card-library.hbs';\nimport getUsersMovieList from '../js/api/firebase/firebase_read_db';\nimport auth from './api/firebase/auth_firebase';\nimport { getAuth, onAuthStateChanged } from 'firebase/auth';\nimport currentUser from './storage/currentUser';\nimport refs from '../constants/refs';\n\nconst axios = require('axios').default;\nconst MOVIE_URL = `https://api.themoviedb.org/3/movie/`;\nconst galleryLibrary = document.querySelector('#library-gallery');\nconst btnSignOut = document.querySelector('#signout-library');\nconst btnWatched = document.querySelector('#btn-watched'); // Select Watched button\nconst btnQueue = document.querySelector('#btn-queue'); // Select Queue button\n\nbtnWatched.addEventListener('click', onLibraryBtnClick); // Set the listener on Watch button\nbtnQueue.addEventListener('click', onLibraryBtnClick); // Set the listener on Queque button\n\nbtnSignOut.addEventListener('click', auth.logOut);\nconst googleUserLibrary = document.querySelector('#googleUserLibrary');\n\nlet pageOfList = 1; // package number\nlet marker = false; // a marker of whether the received packet is drawn\nlet typeOfList = 'btn-queue'; // initial value of page type (Queue)\nlet listofMovie; // global var for scrolling\n\n// -------------------------- drawing initial page\nconst authent = getAuth();\nonAuthStateChanged(authent, user => {\n  if (user) {\n    getUsersMovieList(typeOfList).then(generateLibraryMarkup);\n    googleUserLibrary.textContent = currentUser.userEmail;\n  } else {\n  }\n});\n\n// -------------------------- handle button click\nasync function onLibraryBtnClick(event) {\n  typeOfList = event.target.id; // pull target info about type of list\n  readyToNew(typeOfList); // clear old data\n  await getUsersMovieList(typeOfList, event).then(generateLibraryMarkup); // drawing initial selected page\n}\n\nasync function onAddRemoveBntClick() {\n  galleryLibrary.innerHTML = ''; // clear content\n  await getUsersMovieList(typeOfList).then(generateLibraryMarkup); // drawing initial selected page\n}\n\n// -------------------------- preparation before drawing\nfunction readyToNew(typeOfList) {\n  btnChangeColor(typeOfList); // clear field\n  galleryLibrary.innerHTML = ''; // clear content\n  pageOfList = 1; // return to the initial value of the packet (=1)\n}\n\n// -------------------------- generate the markup\nasync function generateLibraryMarkup(usersList) {\n    const moviesPerPage = 12;                                                                   // cards per fetch\n    listofMovie = usersList;                                                                    // set global value for scrolling                                                                     // current page for markup\n    let startItemPosition = (pageOfList - 1) * moviesPerPage;                                   // first item in list for murkup\n    let onePageList = usersList.slice(startItemPosition, startItemPosition + moviesPerPage);    // get list of movie's id for current fetch\n    onePageList = await makeArreyOfDataMovies(onePageList);                                     // making array of the movie objects = movies id list \n    galleryLibrary.insertAdjacentHTML('beforeend', itemsTemplate(onePageList));                 // drawinf gallery\n    document.body.style.cursor = 'default';                                                     // \n    marker = true;\n    // if (onePageList.length > 0) { refs.footer.style.position = \"static\" };\n}\n\n// -------------------------- making movies data object array\nasync function makeArreyOfDataMovies(array) {\n  document.body.style.cursor = 'wait';\n  const arr = await Promise.all(\n    array.map(async el => {\n      el = await axios.get(`${MOVIE_URL}${el}`, {\n        params: { api_key: constants.API_KEY, language: 'ru-RU' },\n      }); // fetch data by movie id\n      el = el.data;\n      el.name = el.title.toUpperCase(); // ajust data for the template\n      el.release = el.release_date?.slice(0, 4) || 2022;\n      el.genres = el.genres.map(item => (item = item.name)); // convert genres data object to genres array\n      return el;\n    })\n  );\n  return Promise.resolve(arr);\n}\n\n// --------------------------- btn Change Color\nfunction btnChangeColor(ev) {\n  if (ev === 'btn-watched' && !btnWatched.classList.contains('active-btn')) {\n    btnWatched.classList.toggle('active-btn');\n    btnQueue.classList.toggle('active-btn');\n    return;\n  }\n\n  if (ev === 'btn-queue' && !btnQueue.classList.contains('active-btn')) {\n    btnQueue.classList.toggle('active-btn');\n    btnWatched.classList.toggle('active-btn');\n    return;\n  }\n}\n\n// scroll handle to add an endless gallery\nwindow.addEventListener('scroll', () => {\n  const docRect = document.documentElement.getBoundingClientRect(); // gain access to the screen area\n  if (\n    docRect.bottom < document.documentElement.clientHeight + 150 &&\n    marker &&\n    listofMovie.length / 12 >= pageOfList\n  ) {\n    // if the scroll reached 150 from below and the token allows (to avoid duplication of requests), then we process the request\n    marker = false;\n    pageOfList++; // increase the packet number by 1\n    generateLibraryMarkup(listofMovie);\n  }\n\n  if (window.pageYOffset > 70) {\n    // on / off button up\n    refs.upBtn.classList.add('on-screen');\n  } else {\n    refs.upBtn.classList.remove('on-screen');\n  }\n});\n\nexport default onAddRemoveBntClick;\n","{{#each this}}\n  <div class='movie-card'>\n    {{#if poster_path}}\n      <img\n        src='https://image.tmdb.org/t/p/w500{{poster_path}}'\n        alt={{name}}\n        data-id='{{id}}'\n      />\n    {{else}}\n      <img\n        src='https://i.ibb.co/dJhXHZt/filmoteka.png'\n        alt={{name}}\n        data-id='{{id}}'\n      />\n    {{/if}}\n\n    <div class='movie-data'>\n      <h5 class='movie-name'>{{name}}</h5>\n      <p class='movie-info'>{{genres}}\n        |\n        {{release}}\n        <span class='movie-vote'>{{vote_average}}</span></p>\n    </div>\n  </div>\n{{/each}}"],"names":["$bpxeT","parcelRequire","$l5bVx","$3a414a0c09fb77bf$export$2e2bcd8739ae039","$parcel$interopDefault","template","container","depth0","helpers","partials","data","stack1","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","name","hash","fn","program","inverse","loc","start","line","column","end","compiler","main","noop","useData","default","$165c396bfca69de6$var$MOVIE_URL","$165c396bfca69de6$var$galleryLibrary","document","querySelector","$165c396bfca69de6$var$btnSignOut","$165c396bfca69de6$var$btnWatched","$165c396bfca69de6$var$btnQueue","addEventListener","$165c396bfca69de6$var$onLibraryBtnClick","$lFa0r","logOut","$165c396bfca69de6$var$listofMovie","$165c396bfca69de6$var$googleUserLibrary","$165c396bfca69de6$var$pageOfList","$165c396bfca69de6$var$marker","$165c396bfca69de6$var$typeOfList","$165c396bfca69de6$var$authent","$3SEMc","getAuth","event","$165c396bfca69de6$var$_onLibraryBtnClick","apply","this","arguments","$2TvXO","mark","_callee","$165c396bfca69de6$var$readyToNew","target","id","$zBkAB","then","$165c396bfca69de6$var$generateLibraryMarkup","typeOfList1","ev","classList","contains","toggle","$165c396bfca69de6$var$btnChangeColor","innerHTML","usersList","$165c396bfca69de6$var$_generateLibraryMarkup","startItemPosition","onePageList","slice","$165c396bfca69de6$var$makeArreyOfDataMovies","_ctx","sent","insertAdjacentHTML","body","style","cursor","array","$165c396bfca69de6$var$_makeArreyOfDataMovies","_callee1","arr","Promise","all","map","el","ref","$165c396bfca69de6$require$axios","get","concat","params","api_key","$casf1","API_KEY","language","title","toUpperCase","release","release_date","genres","item","_ctx1","resolve","onAuthStateChanged","user","textContent","$havEz","userEmail","window","documentElement","getBoundingClientRect","bottom","clientHeight","length","pageYOffset","$eDusH","upBtn","add","remove"],"version":3,"file":"library.3bb3a278.js.map"}